! ============================================================================
! *** MODULE PARAMS <<<
! ***
! *** Provides all parameter functions which appear in the parabolic
! *** reaction diffusion equation
! ***
! ***     u_t + L_eps = f      on (0,1)x(0,1]
! ***     u(0,t) = gamma_0   , u(1,t) = gamma_1   for all t,
! ***     u(x,0) = u_0                            for all x,
! ***
! *** where
! ***
! ***     L_eps = -eps u_xx + b(x) u .
! ***
! ============================================================================
module params_generic

  USE KINDMOD

  implicit none

  ! strict lower bound on b
  real(RNP),parameter :: rho = 1.0_RNP,  & !lower bound on b
                         x0  = 0.0_RNP,  &
                         x1  = 1.0_RNP,  &
                         T1  = 1.0_RNP

  real(RNP),public :: eps = 1.0E-2_RNP

  contains

! ----------------------------------------------------------------------------
! *** FUNCTION c(x) <<<
! ***
! ----------------------------------------------------------------------------
real(RNP) function c(x)

  !arguments
  real(RNP), intent(in) :: x

  c = 0.0_RNP

end function c
! ---------------------------------- ------------------------------------------
! *** END of FUNCTION c >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION f(t) <<<
! ***
! ----------------------------------------------------------------------------
real(RNP) function f(x,t,eps)

  !arguments
  real(RNP), intent(in) :: x,t,eps

  f = 0.0_RNP

end function f
! ----------------------------------------------------------------------------
! *** END of FUNCTION f >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** function u0 <<<
! ***
! *** u_0(x)
! ***
! ----------------------------------------------------------------------------
real(RNP) pure function u0(x)

  !arguments
  real(RNP),intent(in) :: x

  u0 = 0.0_RNP

end function u0
! ----------------------------------------------------------------------------
! *** END of function u0 >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION gamma0 <<<
! ***
! ----------------------------------------------------------------------------
real(RNP) function gamma0(t)

  !arguments
  real(RNP), intent(in)  :: t

  gamma0 = t

end function gamma0
! ----------------------------------------------------------------------------
! *** END of FUNCTION gamma0 >>>
! ----------------------------------------------------------------------------


! ----------------------------------------------------------------------------
! *** FUNCTION gamma1 <<<
! ***
! ----------------------------------------------------------------------------
real(RNP) function gamma1(t)

  !arguments
  real(RNP), intent(in)  :: t

  gamma1 = (t+ 0.5_RNP / eps)* ERFC(0.5_RNP/SQRT(eps*t)) &
         -     sqrt(t/PI/eps)* EXP(-0.25_RNP/eps/t)

end function gamma1
! ----------------------------------------------------------------------------
! *** END of FUNCTION gamma1 >>>
! ----------------------------------------------------------------------------


! ----------------------------------------------------------------------------
! *** FUNCTION solution(x,t) <<<
! ***
! ----------------------------------------------------------------------------
real(RNP) function solution(x,t,eps)

  !arguments
  real(RNP), intent(in) :: x,t,eps

  !locals
  real(RNP) :: rhoeps

  rhoeps = sqrt(rho)/sqrt(eps)

  solution = ( t + 0.5_RNP*x*x/eps )* ERFC(0.5_RNP*x/SQRT(eps*t)) &
           -        sqrt(t/PI/eps)*x* EXP(-0.25_RNP/eps/t)

end function solution
! ----------------------------------------------------------------------------
! *** END of FUNCTION solution >>>
! ----------------------------------------------------------------------------

end module params_generic
! ============================================================================
! *** END of MODULE PARAMS >>>
! ============================================================================