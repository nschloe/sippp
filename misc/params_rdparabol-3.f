! ============================================================================
! *** MODULE PARAMS <<<
! ***
! *** Provides all parameter functions which appear in the parabolic
! *** reaction diffusion equation
! ***
! ***     u_t + L_eps = f      on (0,1)x(0,1]
! ***     u(0,t) = gamma_0   , u(1,t) = gamma_1   for all t,
! ***     u(x,0) = u_0                            for all x,
! ***
! *** where
! ***
! ***     L_eps = -eps u_xx + b(x) u .
! ***
! ============================================================================
module PARAMS

  USE KINDMOD

  implicit none

  ! strict lower bound on b
  real(dbl_kind),parameter :: rho = 0.99_DBL_KIND, & !strict lower bound on b
                              x0  = 0.0_DBL_KIND,  &
                              x1  = 1.0_DBL_KIND,  &
                              T1  = 1.0_DBL_KIND

  contains

! ----------------------------------------------------------------------------
! *** FUNCTION b(x) <<<
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function b(x)

  !arguments
  real(DBL_KIND), intent(in) :: x

  b = 1.0_DBL_KIND

end function b
! ---------------------------------- ------------------------------------------
! *** END of FUNCTION b >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION f(t) <<<
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function f(x,time,eps)

  !arguments
  real(DBL_KIND), intent(in) :: x,time,eps

  f = Pi*cos(Pi*time) + b(x)*sin(Pi*time)

end function f
! ----------------------------------------------------------------------------
! *** END of FUNCTION f >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** SUBROUTINE u0 <<<
! ***
! *** u_0(x)
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function u0(x,eps)

  !arguments
  real(DBL_KIND),intent(in)  :: x,eps

  u0 = 0.0_DBL_KIND

end function u0
! ----------------------------------------------------------------------------
! *** END of SUBROUTINE u0 >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION gamma0 <<<
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function gamma0(t)

  !arguments
  real(DBL_KIND), intent(in)  :: t

  gamma0 = sin(Pi*t)

end function gamma0
! ----------------------------------------------------------------------------
! *** END of FUNCTION gamma0 >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION gamma1 <<<
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function gamma1(t)

  !arguments
  real(DBL_KIND), intent(in)  :: t

  gamma1 = sin(Pi*t)

end function gamma1
! ----------------------------------------------------------------------------
! *** END of FUNCTION gamma1 >>>
! ----------------------------------------------------------------------------

! ----------------------------------------------------------------------------
! *** FUNCTION solution(x,t) <<<
! ***
! ----------------------------------------------------------------------------
real(dbl_kind) function solution(x,t,eps)

  !arguments
  real(DBL_KIND), intent(in) :: x,t,eps

  solution = sin(Pi*t)

end function solution
! ----------------------------------------------------------------------------
! *** END of FUNCTION solution >>>
! ----------------------------------------------------------------------------

end module PARAMS
! ============================================================================
! *** END of MODULE PARAMS >>>
! ============================================================================